<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Siphawaal.xyz Test Suite</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1e3c72, #2a5298);
            color: white;
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
        }

        h1 {
            text-align: center;
            margin-bottom: 30px;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .test-controls {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .test-button {
            background: linear-gradient(45deg, #4CAF50, #45a049);
            color: white;
            border: none;
            padding: 15px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .test-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.3);
        }

        .test-button.primary {
            background: linear-gradient(45deg, #FF6B35, #F7931E);
            font-size: 18px;
            grid-column: 1 / -1;
        }

        .test-button.secondary {
            background: linear-gradient(45deg, #2196F3, #1976D2);
        }

        .test-button.individual {
            background: linear-gradient(45deg, #9C27B0, #7B1FA2);
        }

        .test-button.danger {
            background: linear-gradient(45deg, #f44336, #d32f2f);
        }

        .console-output {
            background: #000;
            color: #00ff00;
            padding: 20px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.4;
            height: 400px;
            overflow-y: auto;
            margin-top: 20px;
            border: 2px solid #333;
        }

        .status {
            text-align: center;
            padding: 15px;
            margin: 15px 0;
            border-radius: 8px;
            font-weight: bold;
        }

        .status.info {
            background: rgba(33, 150, 243, 0.2);
            border: 1px solid #2196F3;
        }

        .status.success {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
        }

        .status.warning {
            background: rgba(255, 152, 0, 0.2);
            border: 1px solid #FF9800;
        }

        .status.running {
            background: rgba(33, 150, 243, 0.2);
            border: 1px solid #2196F3;
        }

        .status.completed {
            background: rgba(76, 175, 80, 0.2);
            border: 1px solid #4CAF50;
        }

        .status.failed {
            background: rgba(244, 67, 54, 0.2);
            border: 1px solid #f44336;
        }

        .section-title {
            font-size: 1.2em;
            margin: 20px 0 10px 0;
            color: #FFD700;
            border-bottom: 2px solid #FFD700;
            padding-bottom: 5px;
            grid-column: 1 / -1;
        }

        .test-info {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }


        @media (max-width: 768px) {
            .test-controls {
                grid-template-columns: 1fr;
            }

            .test-button.primary {
                grid-column: 1;
            }
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>ğŸ§ª Siphawaal.xyz Test Suite</h1>

        <div class="test-info">
            <p><strong>Welcome to the comprehensive test suite for Siphawaal.xyz!</strong></p>
            <p>This test suite covers all major components including Planet Explorer, Recipe Explorer, ClaimStake Explorer, Resources Explorer, and supporting utilities.</p>
        </div>

        <div id="status" class="status info">
            Ready to run tests. Click any button below to begin testing.
        </div>

        <div class="test-controls">
            <button class="test-button primary" onclick="runFullSuite()">
                ğŸš€ Run All Tests
            </button>

            <div class="section-title">Test Categories</div>

            <button class="test-button secondary" onclick="runCoreTests()">
                ğŸ—ï¸ Core Infrastructure Tests
            </button>

            <button class="test-button secondary" onclick="runExplorerTests()">
                ğŸŒ All Explorer Tests
            </button>

            <button class="test-button secondary" onclick="runQualityTests()">
                âœ¨ Quality Assurance Tests
            </button>

            <div class="section-title">Individual Test Suites</div>

            <button class="test-button individual" onclick="runDataLoaderTestsUI()">
                ğŸ“¥ DataLoader Tests
            </button>

            <button class="test-button individual" onclick="runPlanetTestsUI()">
                ğŸª Planet Explorer Tests
            </button>

            <button class="test-button individual" onclick="runRecipeTestsUI()">
                ğŸ”§ Recipe Explorer Tests
            </button>

            <button class="test-button individual" onclick="runClaimStakeTestsUI()">
                ğŸ­ ClaimStake Explorer Tests
            </button>

            <button class="test-button individual" onclick="runResourcesTestsUI()">
                ğŸ’ Resources Explorer Tests
            </button>

            <button class="test-button individual" onclick="runGaliaViewerTestsUI()">
                ğŸš€ Galia Viewer Tests
            </button>

            <button class="test-button individual" onclick="runUITestsUI()">
                ğŸ¨ UI/UX Tests
            </button>

            <button class="test-button individual" onclick="runPerformanceTestsUI()">
                âš¡ Performance Tests
            </button>

            <button class="test-button individual" onclick="runErrorHandlingTestsUI()">
                ğŸ›¡ï¸ Error Handling Tests
            </button>

            <button class="test-button individual" onclick="runBaseClassTestsUI()">
                ğŸ”§ Base Class Tests
            </button>

            <button class="test-button individual" onclick="runIntegrationTestsUI()">
                ğŸ”— Integration Tests
            </button>

            <div class="section-title">Enhanced Test Suites</div>

            <button class="test-button individual" onclick="runEnhancedTests()">
                ğŸŒŸ All Enhanced Tests
            </button>

            <button class="test-button individual" onclick="runEnhancedResourcesTests()">
                ğŸ’ Enhanced Resources Tests
            </button>

            <button class="test-button individual" onclick="runEnhancedDataLoaderTests()">
                ğŸ“¦ Enhanced DataLoader Tests
            </button>

            <button class="test-button individual" onclick="runEnhancedDOMUtilsTests()">
                ğŸ”§ Enhanced DOMUtils Tests
            </button>

            <button class="test-button individual" onclick="runEnhancedBaseClassTests()">
                ğŸ—ï¸ Enhanced Base Class Tests
            </button>

            <button class="test-button danger" onclick="clearConsole()">
                ğŸ—‘ï¸ Clear Console
            </button>
        </div>


        <div id="console" class="console-output">
            ğŸ”§ Test environment ready. Click a test button to begin...<br>
            ğŸ“Š Test suite includes comprehensive coverage of:<br>
            &nbsp;&nbsp;â€¢ Data loading and processing<br>
            &nbsp;&nbsp;â€¢ UI components and interactions<br>
            &nbsp;&nbsp;â€¢ 3D visualization features (including Galia Viewer)<br>
            &nbsp;&nbsp;â€¢ Performance and error handling<br>
            &nbsp;&nbsp;â€¢ Cross-component integration<br><br>
            ğŸ’¡ Tip: Check browser console for detailed output during test execution.
        </div>
    </div>

    <!-- Load Utils first -->
    <script src="../Utils/DOMUtils.js"></script>
    <script src="../Utils/BaseAnalytics.js"></script>
    <script src="../Utils/BaseExplorer.js"></script>
    <script src="../Utils/BaseApp.js"></script>
    <script src="../Utils/DataLoader.js"></script>

    <!-- Load data files -->
    <script src="../Data/planet-data.js"></script>
    <script src="../Data/buildings-data.js"></script>
    <script src="../Data/resources-data.js"></script>
    <script src="../Data/recipes-data.js"></script>

    <!-- Load explorer modules with cache busting -->
    <script src="../PlanetExplorer/explorer.js?v=20250926"></script>
    <script src="../PlanetExplorer/analytics.js?v=20250926"></script>
    <script src="../RecipeExplorer/analytics.js?v=20250926"></script>
    <script src="../RecipeExplorer/enhanced-tree-renderer.js?v=20250926"></script>
    <script src="../RecipeExplorer/app.js?v=20250926"></script>
    <script src="../ClaimStakeExplorer/explorer.js?v=20250926"></script>
    <script src="../ClaimStakeExplorer/analytics.js?v=20250926"></script>
    <script src="../ClaimStakeExplorer/app.js?v=20250926"></script>
    <script src="../ResourcesExplorer/explorer.js?v=20250926"></script>
    <script src="../ResourcesExplorer/analytics.js?v=20250926"></script>
    <script src="../ResourcesExplorer/app.js?v=20250926"></script>

    <!-- Import map for three.js so example modules can resolve the bare specifier 'three' -->
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.152.2/build/three.module.js"
        }
    }
    </script>

    <!-- Load the unified test suite with cache busting -->
    <script src="test.js?v=20250926"></script>

    <!-- Load enhanced tests -->
    <script src="enhanced-tests.js"></script>

    <!-- Load Galia Viewer tests (depends on test.js) -->
    <script src="galia-viewer-tests.js"></script>

    <!-- Load unified test manager -->
    <script src="unified-test-manager.js"></script>

    <!-- Load three.js (ES modules) and Galia Viewer core -->
    <script type="module" src="../GaliaViewer/core.js"></script>

    <script>
        // Console output redirection
        const consoleDiv = document.getElementById('console');
        const statusDiv = document.getElementById('status');
        const originalConsoleLog = console.log;
        const originalConsoleError = console.error;
        const originalConsoleWarn = console.warn;

        function logToDiv(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const prefix = type === 'error' ? 'âŒ' : type === 'warn' ? 'âš ï¸' : 'ğŸ“';
            consoleDiv.innerHTML += `[${timestamp}] ${prefix} ${message}<br>`;
            consoleDiv.scrollTop = consoleDiv.scrollHeight;
        }

        console.log = function(...args) {
            originalConsoleLog.apply(console, args);
            logToDiv(args.join(' '));
        };

        console.error = function(...args) {
            originalConsoleError.apply(console, args);
            logToDiv(args.join(' '), 'error');
        };

        console.warn = function(...args) {
            originalConsoleWarn.apply(console, args);
            logToDiv(args.join(' '), 'warn');
        };

        // Utility functions
        function updateStatus(message, type) {
            statusDiv.textContent = message;
            statusDiv.className = `status ${type}`;
        }

        function clearConsole() {
            consoleDiv.innerHTML = '';
            updateStatus('Console cleared. Ready for new tests.', 'info');
        }


        // Test runner functions that use the Unified Test Manager
        async function runTestWithStatus(testFunction, testName) {
            updateStatus(`Running ${testName}...`, 'running');
            try {
                if (window.testManager && typeof window.testManager[testFunction] === 'function') {
                    await window.testManager[testFunction]();
                    updateStatus(`${testName} completed!`, 'completed');
                } else {
                    console.log(`âš ï¸ ${testName} not available yet. Test manager loading...`);
                    // Wait and try again
                    setTimeout(async () => {
                        if (window.testManager && typeof window.testManager[testFunction] === 'function') {
                            await window.testManager[testFunction]();
                            updateStatus(`${testName} completed!`, 'completed');
                        } else {
                            console.log(`âŒ ${testName} failed to load`);
                            updateStatus(`${testName} failed to load`, 'failed');
                        }
                    }, 1000);
                }
            } catch (error) {
                console.error(`âŒ Error running ${testName}: ${error.message}`);
                updateStatus(`${testName} failed`, 'failed');
            }
        }

        // Main test suite functions
        async function runFullSuite() {
            await runTestWithStatus('runAllTests', 'All Tests');
        }

        async function runCoreTests() {
            await runTestWithStatus('runCoreTests', 'Core Infrastructure Tests');
        }

        async function runExplorerTests() {
            await runTestWithStatus('runEnhancedTests', 'All Explorer Tests');
        }

        async function runQualityTests() {
            await runTestWithStatus('runPerformanceTests', 'Quality Assurance Tests');
        }

        // Individual test suite functions
        async function runDataLoaderTestsUI() {
            await runTestWithStatus('runDataLoaderTests', 'DataLoader Tests');
        }

        async function runPlanetTestsUI() {
            await runTestWithStatus('runPlanetTests', 'Planet Explorer Tests');
        }

        async function runRecipeTestsUI() {
            await runTestWithStatus('runRecipeTests', 'Recipe Explorer Tests');
        }

        async function runClaimStakeTestsUI() {
            await runTestWithStatus('runClaimStakeTests', 'ClaimStake Explorer Tests');
        }

        async function runResourcesTestsUI() {
            await runTestWithStatus('runResourcesTests', 'Resources Explorer Tests');
        }

        async function runGaliaViewerTestsUI() {
            await runTestWithStatus('runGaliaViewerTests', 'Galia Viewer Tests');
        }

        async function runUITestsUI() {
            await runTestWithStatus('runUITests', 'UI/UX Tests');
        }

        async function runPerformanceTestsUI() {
            await runTestWithStatus('runPerformanceTests', 'Performance Tests');
        }

        async function runErrorHandlingTestsUI() {
            await runTestWithStatus('runErrorTests', 'Error Handling Tests');
        }

        async function runBaseClassTestsUI() {
            await runTestWithStatus('runBaseClassTests', 'Base Class Tests');
        }

        async function runIntegrationTestsUI() {
            await runTestWithStatus('runIntegrationTests', 'Integration Tests');
        }

        // Enhanced test suite functions
        async function runEnhancedTests() {
            await runTestWithStatus('runEnhancedTests', 'All Enhanced Tests');
        }

        async function runEnhancedResourcesTests() {
            await runTestWithStatus('runEnhancedResourcesTests', 'Enhanced Resources Tests');
        }

        async function runEnhancedDataLoaderTests() {
            await runTestWithStatus('runEnhancedDataLoaderTests', 'Enhanced DataLoader Tests');
        }

        async function runEnhancedDOMUtilsTests() {
            await runTestWithStatus('runEnhancedDOMUtilsTests', 'Enhanced DOMUtils Tests');
        }

        async function runEnhancedBaseClassTests() {
            await runTestWithStatus('runEnhancedBaseClassTests', 'Enhanced Base Class Tests');
        }

        // Legacy support functions
        async function runAllTests() {
            await runFullSuite();
        }

        async function runDataLoaderTests() {
            await runDataLoaderTestsUI();
        }

        async function runIntegrationTests() {
            await runIntegrationTestsUI();
        }

        async function runBaseClassTests() {
            await runBaseClassTestsUI();
        }

        async function runRecipeTests() {
            await runRecipeTestsUI();
        }

        async function runClaimStakeTests() {
            await runClaimStakeTestsUI();
        }

        async function runPlanetTests() {
            await runPlanetTestsUI();
        }


        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            console.log('ğŸ§ª Unified Test Runner Interface Loaded');
            console.log('ğŸ“‹ All test suites are managed by the Unified Test Manager');
            console.log('ğŸ’¡ Test manager auto-detects and coordinates all available test suites');
            updateStatus('Test runner loaded successfully. Ready to run tests!', 'info');

            // Check if test manager is ready
            const checkTestManager = setInterval(() => {
                if (window.testManager) {
                    console.log('âœ… Unified Test Manager ready!');
                    updateStatus('All test suites loaded and ready!', 'success');
                    clearInterval(checkTestManager);
                }
            }, 100);

            // Stop checking after 10 seconds
            setTimeout(() => {
                clearInterval(checkTestManager);
                if (!window.testManager) {
                    console.log('âš ï¸ Test manager took longer than expected to load');
                }
            }, 10000);
        });
    </script>
</body>
</html>